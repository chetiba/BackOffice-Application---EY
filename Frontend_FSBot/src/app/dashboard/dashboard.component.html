<div class="container-fluid mt-4">
  <!-- Cadre de présentation de l'application -->
  <div class="row mb-4">
    <div class="col-12">
      <div class="card">
        <div class="card-body">
          <h4 class="card-title text-center">Bienvenue dans l'application FS Transformation</h4>
          <p class="text-muted text-center">
            Cette application a été développée pour simplifier la gestion des collaborateurs, des clients et des missions au sein de notre équipe FS Transformation.
            Elle vous permet de suivre les <strong>actions boursières</strong>, de consulter les <strong>actualités économiques</strong> et de gérer efficacement nos projets.
            Vous y trouverez également des tableaux de bord dédiés à la gestion bancaire, au suivi des stagiaires, ainsi qu'à l'analyse des performances de l'équipe.
            <br>
            Un agent virtuel intelligent est également disponible pour faciliter la récupération des CVs, en vous offrant une recherche intuitive et performante parmi les candidats.
            <br>
            Naviguez à travers les différentes sections pour accéder aux fonctionnalités telles que la gestion des <strong>clients</strong>, des <strong>missions</strong>
            et des <strong>collaborateurs</strong>, ainsi qu'aux <strong>dashboards</strong> bancaire et d'équipe.
          </p>
        </div>
      </div>
    </div>
  </div>
  <div class="row" *ngIf="scrapingData">
    <div class="col-12">
      <h4 class="text-muted">+ FORTES HAUSSES DES ACTIONS BOURSIERES</h4>
    </div>

    <!-- Hausses -->
    <div class="col-xl-3 col-sm-6 grid-margin stretch-card" *ngFor="let hausse of scrapingData.Hausses">
      <div class="card">
        <div class="card-body">
          <div class="row">
            <div class="col-9">
              <div class="d-flex align-items-center align-self-start">
                <h3 class="mb-0">{{ hausse.value }}</h3>
                <p class="text-success ml-2 mb-0 font-weight-medium">{{ hausse.change }}</p>
              </div>
            </div>
            <div class="col-3">
              <div class="icon icon-box-success">
                <span class="mdi mdi-arrow-top-right icon-item"></span>
              </div>
            </div>
          </div>
          <h6 class="text-muted font-weight-normal">{{ hausse.symbol }}</h6>
        </div>
      </div>
    </div>

    <!-- FORTES BAISSES DES ACTIONS BOURSIERES -->
    <div class="col-12 mt-4">
      <h4 class="text-muted">- FORTES BAISSES DES ACTIONS BOURSIERES</h4>
    </div>

    <!-- Baisses -->
    <div class="col-xl-3 col-sm-6 grid-margin stretch-card" *ngFor="let baisse of scrapingData.Baisses">
      <div class="card">
        <div class="card-body">
          <div class="row">
            <div class="col-9">
              <div class="d-flex align-items-center align-self-start">
                <h3 class="mb-0">{{ baisse.value }}</h3>
                <p class="text-danger ml-2 mb-0 font-weight-medium">{{ baisse.change }}</p>
              </div>
            </div>
            <div class="col-3">
              <div class="icon icon-box-danger">
                <span class="mdi mdi-arrow-bottom-left icon-item"></span>
              </div>
            </div>
          </div>
          <h6 class="text-muted font-weight-normal">{{ baisse.symbol }}</h6>
        </div>
      </div>
    </div>
  </div>

  <!-- L'Actualité Economique -->
  <div class="row mt-5">
    <div class="col-12 grid-margin stretch-card">
      <div class="card">
        <div class="card-body">
          <div class="d-flex flex-row justify-content-between">
            <h4 class="card-title mb-1">L'Actualité Economique</h4>
            <div>
              <button (click)="previousPage()" [disabled]="currentPage === 0" class="btn btn-primary">
                <i class="mdi mdi-chevron-left"></i>
              </button>
              <button (click)="nextPage()" [disabled]="currentPage * pageSize + pageSize >= actu.length" class="btn btn-primary">
                <i class="mdi mdi-chevron-right"></i>
              </button>
            </div>
          </div>
          <div class="row">
            <div class="col-12">
              <div class="preview-list">
                <div *ngFor="let article of displayedArticles" class="preview-item border-bottom">
                  <div class="preview-thumbnail">
                    <div class="preview-icon bg-primary">
                      <i class="mdi mdi-newspaper mdi-24px"></i>
                    </div>
                  </div>
                  <div class="preview-item-content d-sm-flex flex-grow">
                    <div class="flex-grow">
                      <h6 class="preview-subject">{{ article.title }}</h6>
                      <p class="text-muted mb-0">{{ article.date }}</p>
                    </div>
                  </div>
                </div>
                <div *ngIf="actu.length === 0">
                  <p>No news to display</p>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- FS Transformation -->
  <div class="row mt-5">
    <div class="col-12 grid-margin stretch-card">
      <div class="card">
        <div class="card-body">
          <h4 class="card-title">FS Transformation</h4>
          <div class="table-responsive">
            <table class="table table-sm">
              <thead>
                <tr>
                  <th class="text-center" style="width: 10%;">Nom</th>
                  <th class="text-center" style="width: 10%;">Photo</th>
                  <th class="text-center" style="width: 10%;">Email</th>
                  <th class="text-center" style="width: 10%;">Grade</th>
                  <th class="text-center" style="width: 10%;">Connecté?</th>
                  <th class="text-center" style="width: 10%;">Actions</th>
                </tr>
              </thead>
              <tbody>
                <tr *ngFor="let user of users">
                  <td class="align-middle">{{ user.prenom }} {{ user.nom }}</td>
                  <td class="align-middle text-center">
                    <img class="img-xs rounded-circle" [src]="getImageUrl(user.id)" alt="profile image" style="width: 30px; height: 30px;">
                  </td>
                  <td class="align-middle">{{ user.username }}</td>
                  <td class="align-middle">{{ user.poste }}</td>
                  <td class="align-middle text-center">
                    <span [ngClass]="{'bg-success': user.is_authenticated, 'bg-danger': !user.is_authenticated}" class="badge badge-pill">
                      {{ user.is_authenticated ? 'Oui' : 'Non' }}
                    </span>
                  </td>
                  <td class="align-middle text-center">
                    <button (click)="openEditModal(editModal, user)" style="margin-right: 10px;">
                      <i class="mdi mdi-tooltip-edit"></i>
                    </button>
                    <button (click)="openDeleteModal(deleteModal, user)">
                      <i class="mdi mdi-delete-forever"></i>
                    </button>
                  </td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>
      </div>
    </div>
  </div>


  <!-- Modal de confirmation de suppression -->
  <ng-template #deleteModal let-modal>
    <div class="modal-header">
      <h5 class="modal-title">Confirmation de suppression</h5>
      <button type="button" class="close" aria-label="Close" (click)="modal.dismiss('Cross click')">
        <span aria-hidden="true">&times;</span>
      </button>
    </div>
    <div class="modal-body">
      <p>Êtes-vous sûr de vouloir supprimer les informations du collaborateur {{ selectedUser.prenom }} {{ selectedUser.nom }} ?</p>
    </div>
    <div class="modal-footer">
      <button type="button" class="btn btn-no-border" (click)="modal.dismiss('Cross click')">Annuler</button>
      <button type="button" class="btn btn-danger" (click)="confirmDelete()">Supprimer</button>
    </div>
  </ng-template>

  <!-- Modal de modification -->
  <ng-template #editModal let-modal>
    <div class="modal-header">
      <h5 class="modal-title" id="modal-basic-title">
        Modification des informations du collaborateur :
        <br>
        <span class="modal-title text-center w-100">{{ selectedUser.prenom }} {{ selectedUser.nom }}</span>
      </h5>
      <button type="button" class="close" aria-label="Close" (click)="modal.dismiss('Cross click')">
        <span aria-hidden="true">&times;</span>
      </button>
    </div>
    <div class="modal-body">
      <form>
        <div class="form-group">
          <label for="poste">Poste</label>
          <select class="form-control" [(ngModel)]="selectedUser.poste" name="poste" required>
            <option value="" disabled>Sélectionner le poste</option>
            <option value="Junior Consultant">Junior Consultant</option>
            <option value="Senior Consultant">Senior Consultant</option>
            <option value="Assistant Manager">Assistant Manager</option>
            <option value="Manager">Manager</option>
            <option value="Senior Manager">Senior Manager</option>
            <option value="Partner">Partner</option>
          </select>
        </div>
        <div class="form-group">
          <label for="competences">Compétences</label>
          <input type="text" class="form-control" id="competences" [(ngModel)]="selectedUser.competences" name="competences">
        </div>
        <div class="form-group">
          <label for="diplome_obtenu">Diplôme obtenu</label>
          <input type="text" class="form-control" id="diplome_obtenu" [(ngModel)]="selectedUser.diplome_obtenu" name="diplome_obtenu">
        </div>
        <div class="form-group">
          <label for="institution">Institution</label>
          <input type="text" class="form-control" id="institution" [(ngModel)]="selectedUser.institution" name="institution">
        </div>
        <div class="form-group">
          <label for="date">Date</label>
          <input type="text" class="form-control" id="date" [(ngModel)]="selectedUser.date" name="date">
        </div>
      </form>
    </div>
    <div class="modal-footer">
      <button type="button" class="btn btn-no-border" (click)="modal.dismiss('Cross click')">Annuler</button>
      <button type="button" class="btn btn-primary" (click)="editUser()">Sauvegarder</button>
    </div>
  </ng-template>
</div>
